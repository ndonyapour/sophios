steps:
- minimize_ligand_only.yml:  # Add hydrogens and minimize the ligand
    in:
      input_path: '*ligand_inp.mol2'
      
- python3_calculate_net_charge:
    in:
      script: /calculate_net_charge.py
      input_path: '*ligand_min.mol2'
      output_log_path: calc_charge_log
      net_charge: '&mol_charge'
        
- acpype_ac: # Generate ligand topology
    in:
      input_path: '*ligand_min.mol2'
      output_path_inpcrd: '&ligand_params.inpcrd'
      output_path_frcmod: '&ligand_params.frcmod'
      output_path_lib: '&ligand_params.lib'
      output_path_prmtop: '&ligand_params.prmtop'
      base_name: output_acpype
      net_charge: '*mol_charge'
- amber_to_pdb:
    in:
      input_top_path: '*ligand_params.prmtop'
      input_crd_path: '*ligand_params.inpcrd'
      output_pdb_path: '&ligand_reduce_H_min.pdb'

wic:
  graphviz:
    label: Generate Ligand\nTopology & Parameters
  steps:
    (1, minimize_ligand_only.yml):
      wic:
        inlineable: False # Due to yml wic tag inlineing issue and ~input_path
        graphviz:
          label: Add Hydrogen Atoms\n and Minimize Ligand
    (2, python3_calculate_net_charge):
      wic:
        graphviz:
          label: Calculate\n the Net Charge
    (3, acpype_ac):
      wic:
        graphviz:
          label: Generate Ligand Topology
    (4, amber_to_pdb):
      wic:
        graphviz:
          label: 'Save as\n PDB File'